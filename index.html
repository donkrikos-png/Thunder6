<!DOCTYPE html>
<html lang="el">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ThunderCats Tactics 3D</title>
<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.min.js"></script>
<style>
  body{margin:0;overflow:hidden;background:#000;font-family:Arial,sans-serif;}
  #game-container{width:100%;height:100%;position:fixed;top:0;left:0;}
  #ui-container{position:fixed;bottom:20px;left:50%;transform:translateX(-50%);display:flex;gap:10px;}
  .action-btn{width:60px;height:60px;border-radius:50%;border:none;background:linear-gradient(45deg,#1e40af,#3b82f6);color:white;font-size:24px;cursor:pointer;display:flex;align-items:center;justify-content:center;}
</style>
</head>
<body>
<div id="game-container"></div>
<div id="ui-container">
  <button class="action-btn" id="move-btn">↑</button>
  <button class="action-btn" id="attack-btn">⚔️</button>
  <button class="action-btn" id="ability-btn">✨</button>
  <button class="action-btn" id="end-turn-btn">✓</button>
</div>

<script>
// ------------------------------
// Global Variables
// ------------------------------
let scene, camera, renderer, controls;
let characters=[];
let selectedCharacter=null;
let isPlayerTurn=true;
const ASSET_URLS={
  models:{
    lion:'https://raw.githubusercontent.com/quaternius/assets/main/character.glb',
    tygra:'https://raw.githubusercontent.com/quaternius/assets/main/character2.glb',
    cheetara:'https://raw.githubusercontent.com/quaternius/assets/main/character3.glb',
    mutant:'https://raw.githubusercontent.com/quaternius/assets/main/enemy.glb',
    rock:'https://raw.githubusercontent.com/KhronosGroup/glTF-Sample-Models/master/2.0/Rock/glTF/Rock.gltf',
    tree:'https://raw.githubusercontent.com/KhronosGroup/glTF-Sample-Models/master/2.0/Tree/glTF/Tree.gltf'
  },
  textures:{
    ground:'https://dl.polyhaven.org/file/ph-assets/Textures/jpg/1k/ground_01.jpg',
    sky:'https://dl.polyhaven.org/file/ph-assets/Textures/jpg/1k/sky_02.jpg',
    crystal:'https://cdn.pixabay.com/photo/2017/01/31/21/18/crystal-2020156_1280.png'
  },
  sounds:{
    bgm:'https://cdn.pixabay.com/download/audio/2021/12/20/audio_0e84f4e4d5.mp3?filename=ambient-forest-110696.mp3',
    attack:'https://freesound.org/data/previews/522/522706_915598-lq.mp3',
    move:'https://freesound.org/data/previews/156/156031_2734680-lq.mp3',
    damage:'https://freesound.org/data/previews/178/178186_2398404-lq.mp3',
    victory:'https://freesound.org/data/previews/331/331912_3248244-lq.mp3'
  }
};

// ------------------------------
// Initialize Scene
// ------------------------------
function initGame(){
  scene=new THREE.Scene();
  scene.background=new THREE.Color(0x0f172a);

  camera=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,0.1,1000);
  camera.position.set(20,25,20);
  camera.lookAt(0,0,0);

  renderer=new THREE.WebGLRenderer({antialias:true});
  renderer.setSize(window.innerWidth,window.innerHeight);
  renderer.shadowMap.enabled=true;
  document.getElementById('game-container').appendChild(renderer.domElement);

  controls=new THREE.OrbitControls(camera,renderer.domElement);
  controls.enableDamping=true;

  // Lights
  const ambient=new THREE.AmbientLight(0x404040,0.6); scene.add(ambient);
  const dir=new THREE.DirectionalLight(0xffffff,0.8); dir.position.set(20,30,20); dir.castShadow=true; scene.add(dir);
  const point=new THREE.PointLight(0x60a5fa,0.5,50); point.position.set(0,10,0); scene.add(point);

  // Ground
  const groundTex=new THREE.TextureLoader().load(ASSET_URLS.textures.ground);
  groundTex.wrapS=groundTex.wrapT=THREE.RepeatWrapping;
  groundTex.repeat.set(20,20);
  const groundMat=new THREE.MeshStandardMaterial({map:groundTex});
  const groundGeo=new THREE.PlaneGeometry(100,100);
  const ground=new THREE.Mesh(groundGeo,groundMat); ground.rotation.x=-Math.PI/2; ground.receiveShadow=true; scene.add(ground);

  // Load characters
  loadCharacter(ASSET_URLS.models.lion,0,0,true,'Lion-O');
  loadCharacter(ASSET_URLS.models.tygra,2,0,true,'Tygra');
  loadCharacter(ASSET_URLS.models.cheetara,0,2,true,'Cheetara');
  loadCharacter(ASSET_URLS.models.mutant,10,10,false,'Mutant');

  // Load environment
  loadModel(ASSET_URLS.models.rock,-5,0,-5);
  loadModel(ASSET_URLS.models.tree,5,0,5);
}

// ------------------------------
// Load GLTF Model
// ------------------------------
function loadModel(url,x,z,callback){
  const loader=new THREE.GLTFLoader();
  loader.load(url,function(gltf){
    const model=gltf.scene;
    model.position.set(x,0,z);
    model.traverse(c=>{if(c.isMesh){c.castShadow=true;c.receiveShadow=true;}});
    scene.add(model);
    if(callback) callback(model);
  });
}

// Load character with metadata
function loadCharacter(url,x,z,isPlayer,name){
  loadModel(url,x,z,mesh=>{
    const character={mesh,name,isPlayer,health:100,maxHealth:100,actionPoints:isPlayer?2:1,maxActionPoints:isPlayer?2:1};
    characters.push(character);
  });
}

// ------------------------------
// Window Resize
// ------------------------------
window.addEventListener('resize',()=>{
  camera.aspect=window.innerWidth/window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth,window.innerHeight);
});

// Start game
window.addEventListener('load',()=>{initGame(); animate();});

// ------------------------------
// Animate Loop
// ------------------------------
function animate(){
  requestAnimationFrame(animate);
  const time=Date.now()*0.001;
  characters.forEach(c=>c.mesh.position.y=Math.sin(time)*0.1);
  controls.update();
  renderer.render(scene,camera);
}
</script>
</body>
</html> <script>
// ------------------------------
// Audio Setup
// ------------------------------
const listener=new THREE.AudioListener();
camera.add(listener);
const audioLoader=new THREE.AudioLoader();
const bgm=new THREE.Audio(listener);
audioLoader.load(ASSET_URLS.sounds.bgm,function(buffer){bgm.setBuffer(buffer);bgm.setLoop(true);bgm.setVolume(0.5);bgm.play();});
const sfx={};
for(const key of ['attack','move','damage','victory']){
  sfx[key]=new THREE.Audio(listener);
  audioLoader.load(ASSET_URLS.sounds[key],buffer=>{sfx[key].setBuffer(buffer);sfx[key].setVolume(0.7);});
}

// ------------------------------
// Character Selection
// ------------------------------
window.addEventListener('click',event=>{
  if(!isPlayerTurn) return;
  const mouse=new THREE.Vector2();
  mouse.x=(event.clientX/window.innerWidth)*2-1;
  mouse.y=-(event.clientY/window.innerHeight)*2+1;
  const raycaster=new THREE.Raycaster();
  raycaster.setFromCamera(mouse,camera);
  const intersects=raycaster.intersectObjects(characters.map(c=>c.mesh));
  if(intersects.length>0){
    const clicked=intersects[0].object;
    const char=characters.find(c=>c.mesh===clicked);
    if(char && char.isPlayer && char.actionPoints>0){
      selectCharacter(char);
    }
  }
});

function selectCharacter(char){
  if(selectedCharacter && selectedCharacter.highlight) selectedCharacter.highlight.visible=false;
  selectedCharacter=char;
  if(!selectedCharacter.highlight){
    const ring=new THREE.RingGeometry(0.6,0.8,16);
    const mat=new THREE.MeshBasicMaterial({color:0xffffff,side:THREE.DoubleSide,transparent:true,opacity:0.5});
    const mesh=new THREE.Mesh(ring,mat);
    mesh.rotation.x=-Math.PI/2;
    mesh.position.y=0.1;
    char.mesh.add(mesh);
    char.highlight=mesh;
  }
  selectedCharacter.highlight.visible=true;
  updateUI();
}

// ------------------------------
// UI Updates
// ------------------------------
function updateUI(){
  if(!selectedCharacter) return;
  // Health & Action points display
  // (Μπορείς να προσθέσεις html divs ή console.log)
  console.log(`${selectedCharacter.name} HP:${selectedCharacter.health} AP:${selectedCharacter.actionPoints}`);
}

// ------------------------------
// Action Buttons
// ------------------------------
document.getElementById('move-btn').addEventListener('click',()=>{
  if(!selectedCharacter || selectedCharacter.actionPoints<1) return;
  console.log(selectedCharacter.name+' moves'); sfx.move.play();
  selectedCharacter.actionPoints--; updateUI();
});
document.getElementById('attack-btn').addEventListener('click',()=>{
  if(!selectedCharacter || selectedCharacter.actionPoints<1) return;
  console.log(selectedCharacter.name+' attacks'); sfx.attack.play();
  selectedCharacter.actionPoints--; updateUI();
});
document.getElementById('ability-btn').addEventListener('click',()=>{
  if(!selectedCharacter || selectedCharacter.actionPoints<1) return;
  console.log(selectedCharacter.name+' uses ability'); sfx.attack.play();
  selectedCharacter.actionPoints--; updateUI();
});
document.getElementById('end-turn-btn').addEventListener('click',endTurn);

// ------------------------------
// Turn System
// ------------------------------
function endTurn(){
  isPlayerTurn=false;
  console.log('Enemy Turn');
  // Simple enemy action simulation
  setTimeout(()=>{
    characters.filter(c=>!c.isPlayer).forEach(enemy=>{
      console.log(enemy.name+' attacks!'); sfx.attack.play();
    });
    // Reset player AP
    characters.filter(c=>c.isPlayer).forEach(p=>p.actionPoints=p.maxActionPoints);
    isPlayerTurn=true;
    console.log('Player Turn');
    updateUI();
  },2000);
}
</script>
